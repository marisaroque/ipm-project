(function(e,t){e.keynav={current_level:0,onClass:"withfocus",openClass:"open",getCurrent:function(t){return(new Array(t+2)).join("."+e.keynav.openClass+" ")},go:function(t){var n=e.keynav.current_level,r=parseInt(e(e.keynav.getCurrent(n)+" [data-level="+n+"]."+e.keynav.onClass).data("index")),i=e(e.keynav.getCurrent(n)+" [data-level="+n+"]").filter("."+e.keynav.onClass);if(i.data("keynav")=="stop")return;i.removeClass(e.keynav.onClass);var s=e(e.keynav.getCurrent(n)+" [data-level="+n+"]").not(".disabled").map(function(t,n){return e(n).data("index")}).get(),o=s.indexOf(r),u=s.length,a=s[((o+t)%u+u)%u],f=e(e.keynav.getCurrent(n)+" [data-level="+n+"][data-index="+a+"]").not(".disabled");f.addClass(e.keynav.onClass)},activate:function(){var t=e.keynav.current_level,n=e(e.keynav.getCurrent(t)+" [data-level="+t+"]").filter("."+e.keynav.onClass);if(n.data("keynav")=="stop")return;n=n.not(".disabled");if(n.size()==0)return;if(n.find("[data-level="+(t+1)+"]").size()!=0){n.addClass(e.keynav.openClass);n.removeClass(e.keynav.onClass);t++;e(e.keynav.getCurrent(t)+" [data-level="+t+"][data-index=0]").addClass(e.keynav.onClass);e.keynav.current_level=t}else n.click()},deactivate:function(){var t=e.keynav.current_level;if(t==0)return;var n=e(e.keynav.getCurrent(t)+" [data-level="+t+"]").not(".disabled").filter("."+e.keynav.onClass);n.trigger("deactivated");if(n.data("keynav")=="stop"){n.removeData("keynav");return}n.removeClass(e.keynav.onClass);t--;var r=e(e.keynav.getCurrent(t)+" [data-level="+t+"]."+e.keynav.openClass);r.removeClass(e.keynav.openClass);r.addClass(e.keynav.onClass);e.keynav.current_level=t}};e.fn.keynav=function(){if(!e.keynav.initialiazed||e.keynav.initialiazed===!1){e(document).keydown(function(t){var n=0;t==null?n=event.keyCode:n=t.which;switch(n){case 37:e.keynav.go(-1);break;case 38:break;case 39:e.keynav.go(1);break;case 40:break;case 13:e.keynav.activate();break;case 27:e.keynav.deactivate()}});e.keynav.initialiazed=!0;e.keynav.go(1)}}})(jQuery);